function safeSendMessage(t){try{if(!chrome||!chrome.runtime||!chrome.runtime.id)return;chrome.runtime.sendMessage(t,e=>{chrome.runtime.lastError})}catch{}}function safeGetURL(t){try{return!chrome||!chrome.runtime||!chrome.runtime.getURL?null:chrome.runtime.getURL(t)}catch{return null}}function safeStorageGet(t,e){try{if(!chrome||!chrome.storage||!chrome.storage.local){e&&e({});return}chrome.storage.local.get(t,e)}catch{e&&e({})}}function safeStorageSet(t,e){try{if(!chrome||!chrome.storage||!chrome.storage.local){e&&e();return}chrome.storage.local.set(t,e)}catch{e&&e()}}function injectScript(t,e){try{const n=safeGetURL(t);if(!n)return;var r=document.getElementsByTagName(e)[0];if(!r)return;var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",n),r.appendChild(o)}catch{}}document.location.href.includes("pokernow.club")?injectScript("js/scripts/pokernow.js","body"):document.location.href.includes("ignitioncasino.eu")&&injectScript("js/scripts/ignition.js","body");function compareHands(t,e){return!t||!e?!1:t.value1==e.value1&&t.suit1==e.suit1&&t.value2==e.value2&&t.suit2==e.suit2}const values=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],DEFAULT_RANGE_VALUES=["A","K","Q","J","10","9","8","7","6","5","4","3","2"],DEFAULT_RANGE_SIZE=169;function buildDefaultRange(){const t=[];for(let e=0;e<DEFAULT_RANGE_VALUES.length;e++)for(let r=0;r<DEFAULT_RANGE_VALUES.length;r++)e>r?t.push(DEFAULT_RANGE_VALUES[r]+" "+DEFAULT_RANGE_VALUES[e]+" o"):t.push(DEFAULT_RANGE_VALUES[e]+" "+DEFAULT_RANGE_VALUES[r]+" s");return t}function normalizeRangeFold(t){const e=!Array.isArray(t?.range)||t.range.length!==DEFAULT_RANGE_SIZE,r=!Array.isArray(t?.fold)||t.fold.length!==DEFAULT_RANGE_SIZE,o=e?buildDefaultRange():t.range,n=r?new Array(DEFAULT_RANGE_SIZE).fill(!1):t.fold;return(e||r)&&safeStorageSet({range:o,fold:n}),{range:o,fold:n}}function checkRange(t){let e=!1;t.suit1==t.suit2&&(e=!0),safeStorageGet(["fold","range"],r=>{const{range:o,fold:n}=normalizeRangeFold(r||{});let i="",a=values.indexOf(t.value1),u=values.indexOf(t.value2);if(a===-1||u===-1){window.postMessage({type:"FROM_EXTENSION",text:!1},"*");return}a<u?i=`${t.value2} ${t.value1}`:i=`${t.value1} ${t.value2}`,t.value1==t.value2||e?i=i+" s":i=i+" o";let l=o.indexOf(i),f=l>=0?!!n[l]:!1;if(f==!1){const s=safeGetURL("media/alert.mp3");if(s){var c=new Audio(s);c.volume=.1,c.play().catch(()=>{})}}else safeStorageGet(["handsFolded"],s=>{let m=(s.handsFolded||0)+1;safeStorageSet({handsFolded:m})});window.postMessage({type:"FROM_EXTENSION",text:f},"*")})}var previousHand;window.addEventListener("message",t=>{if(t.source==window&&t.data.type&&t.data.type=="FROM_PAGE"&&t.data.text){let e=JSON.parse(t.data.text);compareHands(e,previousHand)||(checkRange(e),safeSendMessage({type:"HAND_DATA",data:{value1:e.value1,suit1:e.suit1,value2:e.value2,suit2:e.suit2,url:e.url,playerId:e.playerId,playerName:e.playerName,timestamp:Date.now()}})),previousHand=e}},!1);
